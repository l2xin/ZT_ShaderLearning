<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-MC35ML');</script><script src="https://store.unity.com/themes/contrib/unity_base/js/unity-cdp.js"></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Profiling</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1539961666"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1539961666"></script><script type="text/javascript" src="docdata/toc.js?ts=1539961666"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1539961666"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1539961666">
<link rel="stylesheet" href="../StaticFilesManual/js/feedback/five-star-rating-master/css/rating.min.css">
<script src="../StaticFilesManual/js/feedback/five-star-rating-master/js/src/rating.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="BestPracticeGuides" data-pagetype="normal"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>2018.2</b> (switch to <a href="https://docs.unity3d.com/2018.3/Documentation/Manual">2018.3b</a> or <a href="https://docs.unity3d.com/2017.4/Documentation/Manual">2017.4</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/BestPracticeUnderstandingPerformanceInUnity1.html">English</a></li>
<li><a href="/ja/current/Manual/BestPracticeUnderstandingPerformanceInUnity1.html">日本語</a></li>
<li><a href="/es/current/Manual/BestPracticeUnderstandingPerformanceInUnity1.html">Español</a></li>
<li><a href="/kr/current/Manual/BestPracticeUnderstandingPerformanceInUnity1.html">한국어</a></li>
<li><a href="/ru/current/Manual/BestPracticeUnderstandingPerformanceInUnity1.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2018.2)</a></li>
<li><a href="BestPracticeGuides.html"> Best practice guides</a></li>
<li><a href="BestPracticeUnderstandingPerformanceInUnity.html"> Understanding optimization in Unity</a></li>
<li> Profiling</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity.html"></a></span><div class="tip"> Understanding optimization in Unity</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity2.html"></a></span><div class="tip"> Memory</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div>
<h1>Profiling</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>When discussing performance, it is vital to remember that all optimization attempts must start with a discovery process. Profiling an application to discover its hotspots is the necessary first step, followed by an analysis of profiling results against the project’s technical and <span class="tooltip"><strong>Asset</strong><span class="tooltiptext">Any media or data that can be used in your game or project. An asset may come from a file created outside of Unity, such as a 3D model, an audio file or an image. You can also create some asset types in Unity, such as an Animator Controller, an Audio Mixer or a Render Texture. <a href="AssetWorkflow.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Asset">Glossary</a></span></span></span> architecture.</p>

<p>
<strong>Note</strong>: Where this section discusses method names found in native-code profiling traces, the method names have been drawn from Unity 5.3. Method names may change in future versions of Unity.</p>

<h2>Tools</h2>

<p>For profiling, there are many different tools available to Unity developers. Unity has a suite of built-in tools, such as the <a href="ProfilerCPU.html">CPU Profiler</a>, <a href="ProfilerMemory.html">Memory Profiler</a> and the new 5.3 Memory Analyzer.</p>

<p>However, the best data generally comes from platform-specific tools. These include:</p>

<ul>
<li><p>For <span class="tooltip"><strong>iOS</strong><span class="tooltiptext">Apple’s mobile operating system. <a href="iphone.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#iOS">Glossary</a></span></span></span>: <strong>Instruments</strong> and the <strong>XCode Frame Debugger</strong>
</p></li>
<li><p>For Android: the <strong>Snapdragon Profiler</strong>
</p></li>
<li><p>For platforms running Intel CPUs/GPUs: <strong>VTune</strong> and <strong>Intel GPA</strong>
</p></li>
<li><p>For <span class="tooltip"><strong>PS4</strong><span class="tooltiptext">Sony’s eighth generation video game console.<br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#PS4">Glossary</a></span></span></span>: the <strong>Razor</strong> suite and <strong>VR Trace</strong>
</p></li>
<li><p>For Xbox: the <strong>Pix</strong> tool</p></li>
</ul>

<p>These tools generally have the most utility on platforms that can utilize <span class="tooltip"><a href="IL2CPP.html">IL2CPP</a><span class="tooltiptext">A Unity-developed scripting back-end which you can use as an alternative to Mono when building projects for some platforms. <a href="IL2CPP.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#IL2CPP">Glossary</a></span></span></span> to produce a C++ version of the project. These native-code versions provide transparent callstacks and high-resolution method timings that are unavailable when running under Mono.</p>

<p>Unity has already created a basic guide to using Instruments to profile iOS games; see <a href="http://blogs.unity3d.com/2016/02/01/profiling-with-instruments/">Profiling with Instruments</a>.</p>

<h2>Dissecting startup traces</h2>

<p>When looking at a trace of start-up times, there are two key methods to inspect. These two methods are the primary places where the configuration, Assets and code of a project can impact start-up time.</p>

<p>Note that start-up time manifests differently on different platforms. On most platforms it is visible to the user as a static splash screen.</p>

<figure>
<img src="../uploads/Main/UnderstandingPerformanceinUnity-ProfilingSection_image_0.png" alt="">
</figure>

<p>The above screenshot is from an Instruments trace of an example project running on an iOS device. Within the platform-specific <code>startUnity</code> method, note the <code>UnityInitApplicationGraphics</code> and <code>UnityLoadApplication</code> methods.</p>

<p>
<code>UnityInitApplicationGraphics</code> performs a lot of internal work, such as setting up the graphics device and initializing many of Unity’s internal systems. In addition, it initializes the Resources system. To do this, it must load an index of all of the files contained by the Resources system.</p>

<p>Every Asset file within every folder named “Resources” (1) (NOTE:
 This only applies to folders named “Resources” that are within the project’s “Assets” folder, as well as all child folders within those “Resources” folders.) is included in the Resource system’s data. Therefore, the time required to initialize the Resources system increases at least linearly in correlation with the number of files within “Resources” folders.</p>

<p>
<code>UnityLoadApplication</code> contains methods that load and initialize the first <span class="tooltip"><strong>Scene</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span> in the project. This includes deserializing and instantiating all of the data necessary to display the first <strong>Scene</strong>, such as compiling <span class="tooltip"><strong>Shaders</strong><span class="tooltiptext">A small script that contains the mathematical calculations and algorithms for calculating the Color of each pixel rendered, based on the lighting input and the Material configuration. <a href="Shaders.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#shader">Glossary</a></span></span></span>, uploading Textures and instantiating <span class="tooltip"><strong>GameObjects</strong><span class="tooltiptext">The fundamental object in Unity scenes, which can represent characters, props, scenery, cameras, waypoints, and more. A GameObject’s functionality is defined by the Components attached to it. <a href="class-GameObject.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#GameObject">Glossary</a></span></span></span>. Additionally, all MonoBehaviours in the first <strong>Scene</strong> have their <code>Awake</code> callbacks executed at this time.</p>

<p>These processes mean that if there is any long-running code in an <code>Awake</code> callback in the first Scene of a project, that code could be responsible for slowing down the project’s initial start-up time. Resolving this involves either eliminating the slow code, or executing it elsewhere in the application’s lifecycle.</p>

<h2>Dissecting run time traces</h2>

<p>For profiling traces captured after initial startup time, the primary place of interest is the method <code>PlayerLoop</code>. This is Unity’s main loop, and the code within it runs once per frame.</p>

<figure>
<img src="../uploads/Main/UnderstandingPerformanceinUnity-ProfilingSection_image_1.png" alt="">
</figure>

<p>The above screenshot is from a profiling run of an example Unity 5.4 project, and illustrates several of the most interesting methods within <code>PlayerLoop</code>. Note that the names of methods within the <code>PlayerLoop</code> may vary between Unity versions.</p>

<p>
<code>PlayerRender</code> is the method that runs Unity’s rendering system. This includes culling objects, calculating dynamic batches, and submitting drawing instructions to the GPU. Any Image Effects or rendering-based script callbacks (<code>OnWillRenderObject</code>, for example) also run here. In general, this should be the top consumer of CPU time while the project is interactive.</p>

<p>
<code>BaseBehaviourManager</code> calls three templated versions of <code>CommonUpdate</code>. These invoke certain callbacks within MonoBehaviours attached to active GameObjects in the current Scene.</p>

<ul>
<li><p>
<code>CommonUpdate&lt;UpdateManager&gt;</code> calls <code>Update</code> callbacks</p></li>
<li><p>
<code>CommonUpdate&lt;LateUpdateManager&gt;</code> calls <code>LateUpdate</code> callbacks</p></li>
<li><p>
<code>CommonUpdate&lt;FixedUpdateManager&gt;</code> calls <code>FixedUpdate</code> if the physics system has ticked</p></li>
</ul>

<p>In general, <code>BaseBehaviourManager::CommonUpdate&lt;UpdateManager&gt;</code> is the most interesting method family to inspect, because it is the entry point for most of the script code running within a Unity project.</p>

<p>There are several other methods of interest:</p>

<p>
<code>UI::CanvasManager</code> invokes several different callbacks if a project uses Unity UI. This includes Unity UI’s batch computation and layout updates; the two operations that most often cause <code>CanvasManager</code> to appear in the profiler.</p>

<p>
<code>DelayedCallManager::Update</code> runs coroutines. These are covered in more detail in the “Coroutines” chapter of this document.</p>

<p>
<code>PhysicsManager::FixedUpdate</code> runs the PhysX physics system. This primarily involves running PhysX’s internal code, and is influenced by the number of physics objects in the current Scene, such as Rigidbodies and Colliders. However, physics-based callbacks also appear here – in particular, <code>OnTriggerStay</code> and <code>OnCollisionStay</code>.</p>

<p>If the project is using 2D physics, that appears as an analogous set of calls under <code>Physics2DManager::FixedUpdate</code>.</p>

<h2>Dissecting a script method</h2>

<p>When scripts are invoked on platforms cross-compiled with IL2CPP, look for trace lines containing a <code>ScriptingInvocation</code> object. This is the point where Unity’s internal native code is transitioning into the script runtime in order to execute script code (2) (NOTE:
 Technically, after being run through IL2CPP, C#/JS script code also becomes native code. However, this cross-compiled code primarily executes methods via the IL2CPP runtime framework and does not closely resemble handwritten C++.).</p>

<figure>
<img src="../uploads/Main/UnderstandingPerformanceinUnity-ProfilingSection_image_2.png" alt="">
</figure>

<p>The above screenshot is from another trace from an example project running in Unity 5.4. All of the methods nested beneath the <code>RuntimeInvoker_Void</code> line are part of cross-compiled C# scripts that are being executed once per frame.</p>

<p>The trace lines are fairly easy to read: each one is the name of the original class followed by an underscore and the name of the original method. In this example trace, it’s possible to see <code>EventSystem.Update</code>, <code>PlayerShooting.Update</code> and several other <code>Update</code> methods. These are the standard Unity <code>Update</code> callbacks found in most MonoBehaviours.</p>

<p>By expanding these methods, it is possible to discover exactly which methods within them are consuming CPU time. This includes other script methods within the project, Unity APIs and C# library code.</p>

<p>The above trace shows that the <code>StandaloneInputModule.Process</code> method is raycasting through the entire UI once per frame, in order to detect whether any touch events are hovering over or activating any UI elements. The primary cost is iterating over all the UI elements, and testing whether the mouse’s position is within their bounding rectangle.</p>

<h2>Asset loading</h2>

<p>Asset loading can also be identified in CPU traces. The main method indicating an Asset load is <code>SerializedFile::ReadObject</code>. This method connects a binary data stream (from a file) to Unity’s serialization system, which operates via a method named <code>Transfer</code>. The <code>Transfer</code> method can be found on all Asset types, such as Textures, MonoBehaviours and Particle Systems.</p>

<figure>
<img src="../uploads/Main/UnderstandingPerformanceinUnity-ProfilingSection_image_3.png" alt="">
</figure>

<p>In the above screenshot, a Scene is being loaded. This requires Unity to read and deserialize all the Assets within the Scene, as denoted by the calls to various <code>Transfer</code> methods beneath <code>SerializedFile::ReadObject</code>.</p>

<p>In general, if a performance stutter is seen during runtime and a performance trace shows significant time being used by <code>SerializedFile::ReadObject</code>, the framerate is being reduced due to Asset loads. Note that, in most cases, <code>SerializedFile::ReadObject</code> can be found on the main thread only when synchronous Asset loads are requested via the <code>SceneManager</code>, <code>Resources</code> or AssetBundle APIs.</p>

<p>This sort of performance stutter can be remediated in the usual ways: you can make Asset loading asynchronous (which moves the heavy <code>ReadObject</code> call to a worker thread), or preload certain heavy Assets.</p>

<p>Note that <code>Transfer</code> calls also appear when cloning objects (denoted by the <code>CloneObject</code> method in a trace). If a call to <code>Transfer</code> appears beneath a <code>CloneObject</code> call, then the Asset is not being loaded from storage. Instead, the old Object’s data is being transferred to the new Object. To do this, Unity serializes the old Object and deserializes the resulting data as the new Object.</p>

<h3>Footnotes</h3>

<ul>
<li>(1) This only applies to folders named <em>Resources</em> that are within the project’s <em>Assets</em> folder, as well as all child folders within those <em>Resources</em> folders.</li>
<li>(2) Technically, after being run through IL2CPP, C#/JS script code also becomes native code. However, this cross-compiled code primarily executes methods via the IL2CPP runtime framework and does not closely resemble handwritten C++.</li>
</ul>

<hr>

<ul>
<li><span class="page-edit">2018–04–25 Page amended with limited <a href="DocumentationEditorialReview.html">editorial review</a>
</span></li>
</ul>
<div class="feedbackbox" id="feedbackbox">
<div id="rating"><p>Did you find this page useful? Please give it a rating:<br><div id="ratecontent" class="c-rating"></div>
</p></div>
<div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div>
<div id="problem"><p><a name="problem">Report a problem on this page</a></p></div>
<div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems">
<li><a name="needcode" id="problemneedcode">This page needs code samples</a></li>
<li><a name="code" id="problemcode">Code samples do not work</a></li>
<li><a name="missing" id="problemmissing">Information is missing</a></li>
<li><a name="incorrect" id="problemincorrect">Information is incorrect</a></li>
<li><a name="unclear" id="problemunclear">Information is unclear or confusing</a></li>
<li><a name="language" id="problemlanguage">There is a spelling/grammar error on this page</a></li>
<li><a name="other" id="problemother">Something else</a></li>
</ul>
<p><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues></p>
</p></div>
<div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br><br>If you have time, you can provide more information to help us fix the problem faster.<br><br><a id="problemThanksMoreInfoButton">Provide more information</a><br>
</p></div>
<div id="problemMoreInfo" style="display:none">
<p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p>
<p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p>
<p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p>
<p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p>
<p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p>
<p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p>
<p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p>
<form>
<textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"><input type="submit" id="problemFormDescriptionSubmit" value="Submit">
</form>
</div>
<div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div>
<script>InitialiseStarRating();</script>
</div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="BestPracticeUnderstandingPerformanceInUnity.html"></a></span><div class="tip"> Understanding optimization in Unity</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="BestPracticeUnderstandingPerformanceInUnity2.html"></a></span><div class="tip"> Memory</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2018 Unity Technologies. Publication: 2018.2-002K. Built: 2018-10-10.</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
