<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-MC35ML');</script><script src="https://store.unity.com/themes/contrib/unity_base/js/unity-cdp.js"></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Spatial Mapping common troubleshooting issues</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1539961666"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1539961666"></script><script type="text/javascript" src="docdata/toc.js?ts=1539961666"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1539961666"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1539961666">
<link rel="stylesheet" href="../StaticFilesManual/js/feedback/five-star-rating-master/css/rating.min.css">
<script src="../StaticFilesManual/js/feedback/five-star-rating-master/js/src/rating.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="XR" data-pagetype="normal"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>2018.2</b> (switch to <a href="https://docs.unity3d.com/2018.3/Documentation/Manual">2018.3b</a> or <a href="https://docs.unity3d.com/2017.4/Documentation/Manual">2017.4</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/SpatialMappingTroubleshooting.html">English</a></li>
<li><a href="/ja/current/Manual/SpatialMappingTroubleshooting.html">日本語</a></li>
<li><a href="/es/current/Manual/SpatialMappingTroubleshooting.html">Español</a></li>
<li><a href="/kr/current/Manual/SpatialMappingTroubleshooting.html">한국어</a></li>
<li><a href="/ru/current/Manual/SpatialMappingTroubleshooting.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2018.2)</a></li>
<li><a href="XR.html"> XR</a></li>
<li><a href="XR-SDK_overviews.html"> XR SDKs</a></li>
<li><a href="wmr_sdk_overview.html"> Windows Mixed Reality</a></li>
<li><a href="SpatialMapping.html"> HoloLens Spatial Mapping</a></li>
<li> Spatial Mapping common troubleshooting issues</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SpatialMappingLowLevelApi.html"></a></span><div class="tip"> Spatial Mapping low level API</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="xr_input.html"></a></span><div class="tip"> Unity XR input</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div>
<h1>Spatial Mapping common troubleshooting issues</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Spatial Mapping generates a large amount of data. This has an impact on your application’s speed and performance. This section discusses common issues that can arise from using Spatial Mapping, and guidance on how to avoid those issues.</p>

<h2>Collision data generation takes a long time</h2>

<p>Generating <span class="tooltip"><strong>collision</strong><span class="tooltiptext">A collision occurs when the physics engine detects that the colliders of two GameObjects make contact or overlap, when at least one has a rigidbody component and is in motion. <a href="CollidersOverview.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Collision">Glossary</a></span></span></span> data requires more CPU processing time than any other aspect of Spatial Mapping. Ensuring that <strong>collision</strong> data is only requested when necessary optimizes usage of CPU resources and increase battery life.</p>

<h3>Best practice solution:</h3>

<ul>
<li><p>Only request collision data where necessary. Avoiding collision data requests when they are not necessary decreases the latency for other Spatial Mapping requests, and prolongs battery life.</p></li>
<li><p>Use a <strong>Surface’s</strong> update time and bounding boxes to prioritize data requests, and only request <strong>Surfaces</strong> that are high priority. </p></li>
</ul>

<h2>High triangle densities generate large amounts of geometry</h2>

<p>High values of <a href="../ScriptReference/XR.WSA.SurfaceData-trianglesPerCubicMeter.html">trianglesPerCubicMeter</a>, set through the <a href="../ScriptReference/XR.WSA.SurfaceData.html">SurfaceData</a> struct when requesting <strong>Surface</strong> data using the <a href="../ScriptReference/XR.WSA.SurfaceObserver.RequestMeshAsync.html">RequestMeshAsync</a> method, generate a very large amount of geometry in your <span class="tooltip"><strong>Scene</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span>. This is especially true in spaces containing many objects (like a cluttered office). Large amounts of geometry in your Scene increase data generation latency and the memory usage of your application. Higher <span class="tooltip"><strong>Mesh</strong><span class="tooltiptext">The main graphics primitive of Unity. Meshes make up a large part of your 3D worlds. Unity supports triangulated or Quadrangulated polygon meshes. Nurbs, Nurms, Subdiv surfaces must be converted to polygons. <a href="comp-MeshGroup.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Mesh">Glossary</a></span></span></span> densities in your Scene can also slow down run-time systems such as <span class="tooltip"><strong>rendering</strong><span class="tooltiptext">The process of drawing graphics to the screen (or to a render texture). By default, the main camera in Unity renders its view to the screen. <a href="GraphicsOverview.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Rendering">Glossary</a></span></span></span> and physics, which can affect performance.</p>

<h3>Best practice solution:</h3>

<p>Use the minimum resolution of Spatial Mapping data that your application requires. To do this, you need to test your application and the accuracy of the generated Spatial Mapping mesh, but the result is a balance of accuracy and performance that ultimately offers a much more positive user experience. Lower resolutions of generated Meshes result in less CPU time being spent by your application when the Mesh updates. This reduces the power consumption of your device, increases battery life, and also reduces latency in retrieving Mesh data. Lower resolution Meshes also use less memory and have a less impact on run-time systems such as rendering and physics (which expects low complexity geometry).</p>

<h2>Queuing too many Mesh requests results in unnecessary work</h2>

<p>
<a href="../ScriptReference/XR.WSA.SurfaceObserver.html">SurfaceObservers</a> report all added, updated, and removed <strong>Surfaces</strong> within their volume when you call the <a href="../ScriptReference/XR.WSA.SurfaceObserver.Update.html">SurfaceObserver.Update</a> method.</p>

<p>This adds a list of all changed <strong>Surfaces</strong> to the work queue and can result in unused <strong>Surfaces</strong> remaining in the work queue after Spatial Mapping has removed them. These <strong>Surfaces</strong> still take up CPU time when moving through the system, but do not generate any Mesh data. This increases the latency of any waiting requests.</p>

<h3>Best practice solution:</h3>

<p>Limit the number of <strong>Surfaces</strong> in the work queue where possible. Querying Meshes is an expensive operation with high latency, so keeping only a single <a href="../ScriptReference/XR.WSA.SurfaceObserver.RequestMeshAsync.html">RequestMeshAsync</a> request in use at any given time minimizes any slowdown that these operations cause. Applications can use a <strong>Surface’s</strong> reported update time and bounds to prioritize <code>RequestMeshAsync</code> calls.</p>

<p>It is also important to prioritize <strong>Surface</strong> data requests so that your application receives the most important data first. Examples of common ways to prioritize include:</p>

<ul>
<li><p>Prioritizing new <strong>Surfaces</strong> above updating existing ones.</p></li>
<li><p>Prioritizing <strong>Surfaces</strong> that are closer to the user over those further away.</p></li>
</ul>

<h2>Overlapping SurfaceObserver volumes create duplicate RequestMeshAsync calls</h2>

<p>
<a href="../ScriptReference/XR.WSA.SurfaceObserver.html">SurfaceObservers</a> report changes for all <strong>Surfaces</strong> that overlap their volume. A <strong>Surface</strong> can overlap multiple <code>SurfaceObserver</code> volumes if they are close together. This makes it possible for application code to request the same <strong>Surfaces</strong> multiple times, which can lead to performance issues.</p>

<p><strong>Best practice solution:</strong></p>

<p>Use a single work submission queue for requests from <code>SurfaceObserver</code>. </p>

<p>For many applications, a single <code>SurfaceObserver</code> is often all you need. </p>

<p>Using a single <code>SurfaceObserver</code> can help you reduce the complexity of developing your application. However, there are several advanced uses for <span class="tooltip"><strong>Spatial Mapping</strong><span class="tooltiptext">The process of mapping real-world surfaces into the virtual world. <a href="SpatialMapping.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#SpatialMapping">Glossary</a></span></span></span> that require multiple <code>SurfaceObserver</code> members. In these cases, you should use a single work queue for all <code>SurfaceObserver</code> members in your Scene in order to uniquely prioritize Mesh requests.</p>

<h2>Updating a SurfaceObserver generates no onSurfaceChanged callbacks</h2>

<p>This is a common issue, typically caused by issues in the set-up process.</p>

<h3>Best practice solution:</h3>

<p>Set a valid volume on your <code>SurfaceObserver</code>, using a method such as <a href="../ScriptReference/XR.WSA.SurfaceObserver.SetVolumeAsAxisAlignedBox.html">SetVolumeAsAxisAlignedBox</a>.</p>

<p>You should also make sure that you enable the <strong>Spatial Perception</strong> capability in <strong>Publishing Settings</strong> (menu: <strong>File &gt; Build Settings &gt; Player Settings &gt; Publishing Settings)</strong>. </p>

<p>For more information relating to Capability and Publishing Settings for WMR, see Unity’s <a href="wmr_quick_start.html">Windows Mixed Reality quick starter guide</a>.</p>

<hr>

<ul>
<li><p><span class="page-edit">2018–05–01 Page published with <a href="DocumentationEditorialReview.html">editorial review</a>
</span></p></li>
<li><p><span class="page-history">Spatial Mapping for Hololens documentation updated in 2017.3</span></p></li>
</ul>
<div class="feedbackbox" id="feedbackbox">
<div id="rating"><p>Did you find this page useful? Please give it a rating:<br><div id="ratecontent" class="c-rating"></div>
</p></div>
<div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div>
<div id="problem"><p><a name="problem">Report a problem on this page</a></p></div>
<div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems">
<li><a name="needcode" id="problemneedcode">This page needs code samples</a></li>
<li><a name="code" id="problemcode">Code samples do not work</a></li>
<li><a name="missing" id="problemmissing">Information is missing</a></li>
<li><a name="incorrect" id="problemincorrect">Information is incorrect</a></li>
<li><a name="unclear" id="problemunclear">Information is unclear or confusing</a></li>
<li><a name="language" id="problemlanguage">There is a spelling/grammar error on this page</a></li>
<li><a name="other" id="problemother">Something else</a></li>
</ul>
<p><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues></p>
</p></div>
<div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br><br>If you have time, you can provide more information to help us fix the problem faster.<br><br><a id="problemThanksMoreInfoButton">Provide more information</a><br>
</p></div>
<div id="problemMoreInfo" style="display:none">
<p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p>
<p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p>
<p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p>
<p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p>
<p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p>
<p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p>
<p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p>
<form>
<textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"><input type="submit" id="problemFormDescriptionSubmit" value="Submit">
</form>
</div>
<div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div>
<script>InitialiseStarRating();</script>
</div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="SpatialMappingLowLevelApi.html"></a></span><div class="tip"> Spatial Mapping low level API</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="xr_input.html"></a></span><div class="tip"> Unity XR input</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2018 Unity Technologies. Publication: 2018.2-002K. Built: 2018-10-10.</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
