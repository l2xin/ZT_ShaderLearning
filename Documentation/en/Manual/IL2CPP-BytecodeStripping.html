<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-MC35ML');</script><script src="https://store.unity.com/themes/contrib/unity_base/js/unity-cdp.js"></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual: Managed bytecode stripping with IL2CPP</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1539961666"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1539961666"></script><script type="text/javascript" src="docdata/toc.js?ts=1539961666"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1539961666"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1539961666">
<link rel="stylesheet" href="../StaticFilesManual/js/feedback/five-star-rating-master/css/rating.min.css">
<script src="../StaticFilesManual/js/feedback/five-star-rating-master/js/src/rating.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="ScriptingSection" data-pagetype="normal"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>2018.2</b> (switch to <a href="https://docs.unity3d.com/2018.3/Documentation/Manual">2018.3b</a> or <a href="https://docs.unity3d.com/2017.4/Documentation/Manual">2017.4</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/IL2CPP-BytecodeStripping.html">English</a></li>
<li><a href="/ja/current/Manual/IL2CPP-BytecodeStripping.html">日本語</a></li>
<li><a href="/es/current/Manual/IL2CPP-BytecodeStripping.html">Español</a></li>
<li><a href="/kr/current/Manual/IL2CPP-BytecodeStripping.html">한국어</a></li>
<li><a href="/ru/current/Manual/IL2CPP-BytecodeStripping.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2018.2)</a></li>
<li><a href="ScriptingSection.html">Scripting</a></li>
<li><a href="ScriptingTools.html">Scripting Tools</a></li>
<li><a href="IL2CPP.html">IL2CPP</a></li>
<li>Managed bytecode stripping with IL2CPP</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="IL2CPP-OptimizingBuildTimes.html"></a></span><div class="tip"> Optimizing IL2CPP build times</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptingToolsIDEs.html"></a></span><div class="tip"> Integrated development environment (IDE) support</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div>
<h1>Managed bytecode stripping with IL2CPP</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>Managed bytecode stripping removes unused code from managed assemblies (DLLs). The process works by defining root assemblies, then using static code analysis to determine what other managed code those root assemblies use. Any code that is not reachable is removed. Bytecode stripping will <em>not</em> obfuscate code, nor will it modify code that is used in any way.</p>

<p>For a given Unity player build, the root assemblies are those compiled by the Unity Editor from script code (for example, <em>Assembly-CSharp.dll</em>). Any assemblies compiled from script code will not be stripped, but other assemblies will. This includes:</p>

<ul>
<li>Assemblies you add to a project</li>
<li>Unity Engine assemblies</li>
<li>.NET class library assemblies (e.g mscorlib.dll, System.dll)</li>
</ul>

<p>Managed bytecode stripping is always enabled when the <span class="tooltip"><a href="IL2CPP.html">IL2CPP</a><span class="tooltiptext">A Unity-developed scripting back-end which you can use as an alternative to Mono when building projects for some platforms. <a href="IL2CPP.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#IL2CPP">Glossary</a></span></span></span> <span class="tooltip"><strong>scripting backend</strong><span class="tooltiptext">A framework that powers scripting in Unity. Unity supports three different scripting backends depending on target platform: Mono, .NET and IL2CPP. Universal Windows Platform, however, supports only two: .NET and IL2CPP. <a href="windowsstore-scriptingbackends.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#ScriptingBackend">Glossary</a></span></span></span> is used. In this case, the Stripping Level option is replaced with a Boolean option named Strip Engine Code. If this option is enabled, unused modules and classes in the <em>native</em> Unity Engine code will be also removed. If it is disabled, all of the modules and classes in the native Unity Engine code will be preserved.</p>

<p>The <em>link.xml</em> file (described below) can be used to effectively disable bytecode stripping by preserving both types and full assemblies. For example, to prevent the System assembly from being stripped, the following link.xml file can be used:</p>

<pre><code>&lt;linker&gt;
       &lt;assembly fullname=&quot;System&quot; preserve=&quot;all&quot;/&gt;
&lt;/linker&gt;
</code></pre>

<h2>Tips</h2>

<h3>How to deal with stripping when using reflection</h3>

<p>Stripping depends highly on static code analysis and sometimes this can’t be done effectively, especially when dynamic features like reflection are used. In such cases, it is necessary to give some hints as to which classes shouldn’t be touched. Unity supports a per-project custom stripping blacklist. Using the blacklist is a simple matter of creating a link.xml file and placing it into the <span class="tooltip"><strong>Assets</strong><span class="tooltiptext">Any media or data that can be used in your game or project. An asset may come from a file created outside of Unity, such as a 3D model, an audio file or an image. You can also create some asset types in Unity, such as an Animator Controller, an Audio Mixer or a Render Texture. <a href="AssetWorkflow.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Asset">Glossary</a></span></span></span> folder (or any subdirectory of Assets). An example of the contents of the link.xml file follows. Classes marked for preservation will not be affected by stripping:</p>

<pre><code>&lt;linker&gt;
       &lt;assembly fullname=&quot;System.Web.Services&quot;&gt;
               &lt;type fullname=&quot;System.Web.Services.Protocols.SoapTypeStubInfo&quot; preserve=&quot;all&quot;/&gt;
       &lt;/assembly&gt;

       &lt;assembly fullname=&quot;System&quot;&gt;
               &lt;type fullname=&quot;System.Net.Configuration.WebRequestModuleHandler&quot; preserve=&quot;all&quot;/&gt;
               &lt;type fullname=&quot;System.Net.HttpRequestCreator&quot; preserve=&quot;all&quot;/&gt;
               &lt;type fullname=&quot;System.Net.FileWebRequestCreator&quot; preserve=&quot;all&quot;/&gt;
       &lt;/assembly&gt;

       &lt;assembly fullname=&quot;mscorlib&quot;&gt;
               &lt;type fullname=&quot;System.AppDomain&quot; preserve=&quot;fields&quot;/&gt;
               &lt;type fullname=&quot;System.InvalidOperationException&quot; preserve=&quot;fields&quot;&gt;
                       &lt;method signature=&quot;System.Void .ctor()&quot;/&gt;
               &lt;/type&gt;
               &lt;type fullname=&quot;System.Object&quot; preserve=&quot;nothing&quot;&gt;
                      &lt;method name=&quot;Finalize&quot;/&gt;
               &lt;/type&gt;
       &lt;/assembly&gt;
&lt;/linker&gt;
</code></pre>

<p>A project can include multiple link.xml files. Each link.xml file can specify a number of different options.
The assembly element indicates the managed assembly where the nested directives should apply.</p>

<p>The type element is used to indicate how a specific type should be handled. It must be a child of the assembly element. The fullname attribute can accept the ‘*’ wild card to match one or more characters.</p>

<p>The preserve attribute can take on one of three values:</p>

<ul>
<li>
<strong>all:</strong> Keep everything from the given type (or assembly, for IL2CPP only).</li>
<li>
<strong>fields:</strong> Keep only the fields of the given type.</li>
<li>
<strong>nothing:</strong> Keep only the given type, but none of its contents.</li>
</ul>

<p>The method element is used to indicate that a specific method should be preserved. It must be a child of the type element. The method can be specified by name or by signature.</p>

<p>In addition to the link.xml file, the C# <code>[Preserve]</code> attribute can be used in source code to prevent the linker from stripping that code. This attribute behaves slightly differently than corresponding entries in a link.xml file:</p>

<ul>
<li>
<strong>Assembly:</strong> preserves all types in the assembly (as if a <code>[Preserve]</code> attribute were on each type)</li>
<li>
<strong>Type:</strong> preserves the type and its default constructor</li>
<li>
<strong>Method:</strong> preserves the method’s declaring type, return type, and the types of all of its arguments</li>
<li>
<strong>Property, Field, Event:</strong> preserves the declaring type and return type of the property, field, or event</li>
</ul>

<p>The stripped assemblies are output to a directory below the Temp directory in the project (the exact location varies depending on the target platform). The original, unstripped assemblies are available in the not-stripped directory in the same location as the stripped assemblies. A tool like ILSpy can be used to inspect the stripped and unstripped assemblies to determine what parts of the code were removed.</p>

<hr>

<ul>
<li><p><span class="page-edit">2017–09–01 Page amended with limited <a href="DocumentationEditorialReview.html">editorial review</a>
</span></p></li>
<li><p><span class="page-history">2017–05–26 - Documentation-only update in Unity User Manual for Unity 5.6</span></p></li>
<li><p><span class="page-history">2017–09–01 - Added advice on using C# <code>[Preserve]</code> attribute for Unity 2017.1</span></p></li>
</ul>
<div class="feedbackbox" id="feedbackbox">
<div id="rating"><p>Did you find this page useful? Please give it a rating:<br><div id="ratecontent" class="c-rating"></div>
</p></div>
<div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div>
<div id="problem"><p><a name="problem">Report a problem on this page</a></p></div>
<div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems">
<li><a name="needcode" id="problemneedcode">This page needs code samples</a></li>
<li><a name="code" id="problemcode">Code samples do not work</a></li>
<li><a name="missing" id="problemmissing">Information is missing</a></li>
<li><a name="incorrect" id="problemincorrect">Information is incorrect</a></li>
<li><a name="unclear" id="problemunclear">Information is unclear or confusing</a></li>
<li><a name="language" id="problemlanguage">There is a spelling/grammar error on this page</a></li>
<li><a name="other" id="problemother">Something else</a></li>
</ul>
<p><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues></p>
</p></div>
<div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br><br>If you have time, you can provide more information to help us fix the problem faster.<br><br><a id="problemThanksMoreInfoButton">Provide more information</a><br>
</p></div>
<div id="problemMoreInfo" style="display:none">
<p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p>
<p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p>
<p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p>
<p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p>
<p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p>
<p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p>
<p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p>
<form>
<textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"><input type="submit" id="problemFormDescriptionSubmit" value="Submit">
</form>
</div>
<div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div>
<script>InitialiseStarRating();</script>
</div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="IL2CPP-OptimizingBuildTimes.html"></a></span><div class="tip"> Optimizing IL2CPP build times</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="ScriptingToolsIDEs.html"></a></span><div class="tip"> Integrated development environment (IDE) support</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2018 Unity Technologies. Publication: 2018.2-002K. Built: 2018-10-10.</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
