<!DOCTYPE html><html lang="en" class="no-js">
<head>
<meta content="text/html; charset=UTF-8" http-equiv="Content-Type">
<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':  new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],   j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=   'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);  })(window,document,'script','dataLayer','GTM-MC35ML');</script><script src="https://store.unity.com/themes/contrib/unity_base/js/unity-cdp.js"></script><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unity - Manual:  Custom Player Spawning</title>
<meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg">
<meta name="author" content="Unity Technologies">
<link rel="shortcut icon" href="../StaticFilesManual/images/favicons/favicon.ico">
<link rel="icon" type="image/png" href="../StaticFilesManual/images/favicons/favicon.png">
<link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFilesManual/images/favicons/apple-touch-icon-152x152.png">
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFilesManual/images/favicons/apple-touch-icon-144x144.png">
<link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFilesManual/images/favicons/apple-touch-icon-120x120.png">
<link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFilesManual/images/favicons/apple-touch-icon-114x114.png">
<link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFilesManual/images/favicons/apple-touch-icon-72x72.png">
<link rel="apple-touch-icon-precomposed" href="../StaticFilesManual/images/favicons/apple-touch-icon.png">
<meta name="msapplication-TileColor" content="#222c37">
<meta name="msapplication-TileImage" content="../StaticFilesManual/images/favicons/tileicon-144x144.png">
<script type="text/javascript" src="../StaticFilesManual/js/jquery.js?ts=1539961666"></script><script type="text/javascript" src="../StaticFilesManual/js/core.js?ts=1539961666"></script><script type="text/javascript" src="docdata/toc.js?ts=1539961666"></script><script type="text/javascript" src="docdata/global_toc.js?ts=1539961666"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css">
<link rel="stylesheet" type="text/css" href="../StaticFilesManual/css/core.css?ts=1539961666">
<link rel="stylesheet" href="../StaticFilesManual/js/feedback/five-star-rating-master/css/rating.min.css">
<script src="../StaticFilesManual/js/feedback/five-star-rating-master/js/src/rating.js"></script>
</head>
<body>
<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
<div id="DocsAnalyticsData" data-area="UNet" data-pagetype="normal"></div>
<div class="header-wrapper">
<div id="header" class="header"><div class="content">
<div class="spacer"><div class="menu">
<div class="logo"><a href="https://docs.unity3d.com"></a></div>
<div class="search-form"><form action="30_search.html" method="get" class="apisearch">
<input type="text" name="q" placeholder="Search manual..." autosave="Unity Reference" results="5" class="sbox field" id="q"><input type="submit" class="submit">
</form></div>
<ul>
<li><a href="../Manual/index.html" class="selected">Manual</a></li>
<li><a href="../ScriptReference/index.html">Scripting API</a></li>
</ul>
</div></div>
<div class="more">
<div class="filler"></div>
<ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul>
</div>
</div></div>
<div class="toolbar"><div class="content">
<div class="version-number">Version: <b>2018.2</b> (switch to <a href="https://docs.unity3d.com/2018.3/Documentation/Manual">2018.3b</a> or <a href="https://docs.unity3d.com/2017.4/Documentation/Manual">2017.4</a>)</div>
<div class="lang-switcher">
<div class="current toggle" data-target=".lang-list">
<div class="lbl">Language: <span class="b">English</span>
</div>
<div class="arrow"></div>
</div>
<div class="lang-list" style="display:none;"><ul>
<li><a href="/Manual/UNetPlayersCustom.html">English</a></li>
<li><a href="/ja/current/Manual/UNetPlayersCustom.html">日本語</a></li>
<li><a href="/es/current/Manual/UNetPlayersCustom.html">Español</a></li>
<li><a href="/kr/current/Manual/UNetPlayersCustom.html">한국어</a></li>
<li><a href="/ru/current/Manual/UNetPlayersCustom.html">Русский</a></li>
</ul></div>
</div>
</div></div>
</div>
<div id="master-wrapper" class="master-wrapper clear">
<div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Unity Manual</h2></div></div></div></div></div>
<div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content">
<div class="section">
<div class="breadcrumbs clear"><ul>
<li><a href="UnityManual.html">Unity User Manual (2018.2)</a></li>
<li><a href="UNet.html">Multiplayer and Networking</a></li>
<li><a href="UNetUsingHLAPI.html">The Multiplayer High Level API</a></li>
<li><a href="UNetGameObjects.html"> Networked GameObjects</a></li>
<li> Custom Player Spawning</li>
</ul></div>
<div class="mb20"><div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UNetPlayers.html"></a></span><div class="tip"> Player GameObjects</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UNetSpawning.html"></a></span><div class="tip"> Spawning GameObjects</div>
</div>
</div></div>
<div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)">
<a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display: none;">Cannot access other versions offline!</div>
</div>
<div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div>
<h1>Custom Player Spawning</h1>
<!--BeginSwitchLink--><!--EndSwitchLink-->
<div class="clear"></div>

<p>The <span class="tooltip"><strong>Network Manager</strong><span class="tooltiptext">A Networking component that manages the network state of a Project. <a href="class-NetworkManager.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#NetworkManager">Glossary</a></span></span></span> offers a built-in simple player spawning feature, however you may want to customize the player spawning process - for example to assign a colour to each new player spawned.</p>

<p>To do this you need to override the default behaviour of the Network Manager with your own script.</p>

<p>When the Network Manager adds a player, it also instantiates a <span class="tooltip"><strong>GameObject</strong><span class="tooltiptext">The fundamental object in Unity scenes, which can represent characters, props, scenery, cameras, waypoints, and more. A GameObject’s functionality is defined by the Components attached to it. <a href="class-GameObject.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#GameObject">Glossary</a></span></span></span> from the Player <span class="tooltip"><strong>Prefab</strong><span class="tooltiptext">An asset type that allows you to store a GameObject complete with components and properties. The prefab acts as a template from which you can create new object instances in the scene. <a href="Prefabs.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Prefab">Glossary</a></span></span></span> and associates it with the connection. To do this, the Network Manager calls <a href="../ScriptReference/Networking.NetworkServer.AddPlayerForConnection.html">NetworkServer.AddPlayerForConnection</a>. You can modify this behaviour by overriding <a href="../ScriptReference/Networking.NetworkManager.OnServerAddPlayer.html">NetworkManager.OnServerAddPlayer</a>. The default implementation of <code>OnServerAddPlayer</code> instantiates a new player instance from the player Prefab and calls <a href="../ScriptReference/Networking.NetworkServer.AddPlayerForConnection.html">NetworkServer.AddPlayerForConnection</a> to spawn the new player instance. Your custom implementation of <code>OnServerAddPlayer</code> must also call <code>NetworkServer.AddPlayerForConnection</code>, but your are free to perform any other initialization you require in that method too. </p>

<p>The example below customizes the color of a player. First, add the color script to the player prefab:</p>

<pre><code>using UnityEngine;
using UnityEngine.Networking;
class Player : NetworkBehaviour
{
    [SyncVar]
    public Color color;
}
</code></pre>

<p>Next, create a <a href="../ScriptReference/Networking.NetworkManager.html">NetworkManager</a> to handle spawning.</p>

<pre><code>using UnityEngine;
using UnityEngine.Networking;
public class MyNetworkManager : NetworkManager
{
    public override void OnServerAddPlayer(NetworkConnection conn, short playerControllerId)
    {
        GameObject player = (GameObject)Instantiate(playerPrefab, Vector3.zero, Quaternion.identity);
        player.GetComponent&lt;Player&gt;().color = Color.red;
        NetworkServer.AddPlayerForConnection(conn, player, playerControllerId);
    }
}
</code></pre>

<p>The function <code>NetworkServer.AddPlayerForConnection</code> does not have to be called from within <code>OnServerAddPlayer</code>. As long as the correct connection object and <code>playerControllerId</code> are passed in, it can be called after <code>OnServerAddPlayer</code> has returned. This allows asynchronous steps to happen in between, such as loading player data from a remote data source.</p>

<p>Although in most multiplayer games, you typically want one player for each client, the <a href="UNetUsingHLAPI.html">HLAPI</a> treats players and clients as separate concepts.This is because, in some situations (for example, if you have multiple controllers connected to a console system), you might need multiple player GameObjects for a single connection. When there are multiple players on one connection, you should use the <code>playerControllerId</code> property to tell them apart. This identifier is scoped to the connection, so that it maps to the ID of the controller associated with the player on that client.</p>

<p>The system automatically spawns the player GameObject passed to <code>NetworkServer.AddPlayerForConnection</code> on the server, so you don’t need to call <a href="../ScriptReference/Networking.NetworkServer.Spawn.html">NetworkServer.Spawn</a> for the player. Once a player is ready, the active networked GameObjects (that is, GameObjects with an associated <span class="tooltip"><a href="UNetSpawning.html">NetworkIdentity</a><span class="tooltiptext">A Networking component that allows you to assign an identity to your GameObject for the network to recognise it as a Local Player GameObject or a Server Only GameObject. <a href="class-NetworkIdentity.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#NetworkIdentity">Glossary</a></span></span></span>) in the <span class="tooltip"><strong>Scene</strong><span class="tooltiptext">A Scene contains the environments and menus of your game. Think of each unique Scene file as a unique level. In each Scene, you place your environments, obstacles, and decorations, essentially designing and building your game in pieces. <a href="CreatingScenes.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Scene">Glossary</a></span></span></span> spawn on the player’s client. All networked GameObjects in the game are created on that client with their latest state, so they are in sync with the other participants of the game.</p>

<p>You don’t need to use <a href="../ScriptReference/Networking.NetworkManager-playerPrefab.html">playerPrefab</a> on the <code>NetworkManager</code> to create player GameObjects. You could use different methods of creating different players.</p>

<h2>Ready state</h2>

<p>In addition to players, client connections also have a “ready” state. The host sends clients that are ready information about spawned GameObjects and state synchronization updates; clients which are not ready are not sent these updates. When a client initially connects to a server, it is not ready. While in this non-ready state, the client can do things that don’t require real-time interactions with the game state on the server, such as loading Scenes, allowing the player to choose an <span class="tooltip"><strong>avatar</strong><span class="tooltiptext">An interface for retargeting animation from one rig to another. <a href="ConfiguringtheAvatar.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Avatar">Glossary</a></span></span></span>, or fill in log-in boxes. Once a client has completed all its pre-game work, and all its <span class="tooltip"><strong>Assets</strong><span class="tooltiptext">Any media or data that can be used in your game or project. An asset may come from a file created outside of Unity, such as a 3D model, an audio file or an image. You can also create some asset types in Unity, such as an Animator Controller, an Audio Mixer or a Render Texture. <a href="AssetWorkflow.html">More info</a><br/><span class="tooltipGlossaryLink">See in <a href="Glossary.html#Asset">Glossary</a></span></span></span> are loaded, it can call <a href="../ScriptReference/Networking.ClientScene-ready.html">ClientScene.Ready</a> to enter the “ready” state. The simple example above demonstrates implementation of ready states; because adding a player with <code>NetworkServer.AddPlayerForConnection</code> also puts the client into the ready state if it is not already in that state.</p>

<p>Clients can send and receive network messages without being ready, which also means they can do so without having an active player GameObject. So a client at a menu or selection screen can connect to the game and interact with it, even though they have no player GameObject. See documentation on <a href="UNetMessages.html">Network messages</a> for more details about sending messages without using commands and RPC calls.</p>

<h2>Switching players</h2>

<p>To replace the player GameObject for a connection, use <a href="../ScriptReference/Networking.NetworkServer.ReplacePlayerForConnection.html">NetworkServer.ReplacePlayerForConnection</a>. This is useful for restricting the commands that players can issue at certain times, such as in a pre-game lobby screen. This function takes the same arguments as <code>AddPlayerForConnection</code>, but allows there to already be a player for that connection. The old player GameObject does not have to be destroyed. The <a href="../ScriptReference/Networking.NetworkLobbyManager.html">NetworkLobbyManager</a> uses this technique to switch from the <a href="../ScriptReference/Networking.NetworkLobbyPlayer.html">NetworkLobbyPlayer</a> GameObject to a gameplay player GameObject when all the players in the lobby are ready.</p>

<p>You can also use <code>ReplacePlayerForConnection</code> to respawn a player after their GameObject is destroyed. In some cases it is better to just disable a GameObject and reset its game attributes on respawn. The following code sample demonstrates how to actually replace the destroyed GameObject with a new GameObject:</p>

<pre><code>class GameManager
{
    public void PlayerWasKilled(Player player)
    {
        var conn = player.connectionToClient;
        var newPlayer = Instantiate&lt;GameObject&gt;(playerPrefab);
        Destroy(player.gameObject);
        NetworkServer.ReplacePlayerForConnection(conn, newPlayer, 0);
    }
}
</code></pre>

<p>If the player GameObject for a connection is destroyed, then that client cannot execute Commands. They can, however, still send network messages.</p>

<p>To use <code>ReplacePlayerForConnection</code> you must have the <a href="../ScriptReference/Networking.NetworkConnection.html">NetworkConnection</a> GameObject for the player’s client to establish the relationship between the GameObject and the client. This is usually the property <a href="../ScriptReference/Networking.NetworkBehaviour-connectionToClient.html">connectionToClient</a> on the <a href="../ScriptReference/Networking.NetworkBehaviour.html">NetworkBehaviour</a> class, but if the old player has already been destroyed, then that might not be readily available.</p>

<p>To find the connection, there are some lists available. If using the <code>NetworkLobbyManager</code>, then the lobby players are available in <a href="../ScriptReference/Networking.NetworkLobbyManager-lobbySlots.html">lobbySlots</a>. The <a href="../ScriptReference/Networking.NetworkServer.html">NetworkServer</a> also has lists of <a href="../ScriptReference/Networking.NetworkServer-connections.html">connections</a> and <a href="../ScriptReference/Networking.NetworkServer-localConnections.html">localConnections</a>.</p>
<div class="feedbackbox" id="feedbackbox">
<div id="rating"><p>Did you find this page useful? Please give it a rating:<br><div id="ratecontent" class="c-rating"></div>
</p></div>
<div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div>
<div id="problem"><p><a name="problem">Report a problem on this page</a></p></div>
<div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems">
<li><a name="needcode" id="problemneedcode">This page needs code samples</a></li>
<li><a name="code" id="problemcode">Code samples do not work</a></li>
<li><a name="missing" id="problemmissing">Information is missing</a></li>
<li><a name="incorrect" id="problemincorrect">Information is incorrect</a></li>
<li><a name="unclear" id="problemunclear">Information is unclear or confusing</a></li>
<li><a name="language" id="problemlanguage">There is a spelling/grammar error on this page</a></li>
<li><a name="other" id="problemother">Something else</a></li>
</ul>
<p><known_issues><p>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at <a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p></known_issues></p>
</p></div>
<div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br><br>If you have time, you can provide more information to help us fix the problem faster.<br><br><a id="problemThanksMoreInfoButton">Provide more information</a><br>
</p></div>
<div id="problemMoreInfo" style="display:none">
<p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p>
<p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p>
<p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p>
<p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p>
<p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p>
<p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p>
<p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p>
<form>
<textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"><input type="submit" id="problemFormDescriptionSubmit" value="Submit">
</form>
</div>
<div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div>
<script>InitialiseStarRating();</script>
</div>
<div class="nextprev clear">
<div class="icon tt left mr1" data-distance="-40|-30|top">
<span class="prev"><a href="UNetPlayers.html"></a></span><div class="tip"> Player GameObjects</div>
</div>
<div class="icon tt right" data-distance="-40|-30|top">
<span class="next"><a href="UNetSpawning.html"></a></span><div class="tip"> Spawning GameObjects</div>
</div>
</div>
</div>
<div class="footer-wrapper"><div class="footer clear">
<div class="copy">Copyright © 2018 Unity Technologies. Publication: 2018.2-002K. Built: 2018-10-10.</div>
<div class="menu">
<a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a>
</div>
</div></div>
</div></div></div>
</div>
</body>
</html>
