<!DOCTYPE html><html lang="en" class="no-js"><head><script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start': new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0], j=d.createElement(s),dl=l!='dataLayer'?'&amp;l='+l:'';j.async=true;j.src= 'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f); })(window,document,'script','dataLayer','GTM-MC35ML');</script><script src="https://store.unity.com/themes/contrib/unity_base/js/unity-cdp.js"></script><meta charset="utf-8" /><meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" /><meta name="viewport" content="width=device-width, initial-scale=1.0" /><title>Unity - Scripting API: Networking.NetworkTransport.Send</title><meta property="og:image" content="https://unity3d.com/files/images/ogimg.jpg" /><meta name="author" content="Unity Technologies" /><link rel="shortcut icon" href="../StaticFiles/images/favicons/favicon.ico" /><link rel="icon" type="image/png" href="../StaticFiles/images/favicons/favicon.png" /><link rel="apple-touch-icon-precomposed" sizes="152x152" href="../StaticFiles/images/favicons/apple-touch-icon-152x152.png" /><link rel="apple-touch-icon-precomposed" sizes="144x144" href="../StaticFiles/images/favicons/apple-touch-icon-144x144.png" /><link rel="apple-touch-icon-precomposed" sizes="120x120" href="../StaticFiles/images/favicons/apple-touch-icon-120x120.png" /><link rel="apple-touch-icon-precomposed" sizes="114x114" href="../StaticFiles/images/favicons/apple-touch-icon-114x114.png" /><link rel="apple-touch-icon-precomposed" sizes="72x72" href="../StaticFiles/images/favicons/apple-touch-icon-72x72.png" /><link rel="apple-touch-icon-precomposed" href="../StaticFiles/images/favicons/apple-touch-icon.png" /><meta name="msapplication-TileColor" content="#222c37" /><meta name="msapplication-TileImage" content="../StaticFiles/images/favicons/tileicon-144x144.png" /><script type="text/javascript" src="../StaticFiles/js/jquery.js"></script><script type="text/javascript" src="docdata/toc.js">//toc</script><!--local TOC--><script type="text/javascript" src="docdata/global_toc.js">//toc</script><!--global TOC, including other platforms--><script type="text/javascript" src="../StaticFiles/js/core.js"></script><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,700,400italic" rel="stylesheet" type="text/css" /><link rel="stylesheet" type="text/css" href="../StaticFiles/css/core.css" /><link rel="stylesheet" href="../StaticFiles/js/feedback/five-star-rating-master/css/rating.min.css" /><script src="../StaticFiles/js/feedback/five-star-rating-master/js/src/rating.js"></script></head><body><noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-MC35ML" height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript><div class="header-wrapper"><div id="header" class="header"><div class="content"><div class="spacer"><div class="menu"><div class="logo"><a href=""></a></div><div class="search-form"><form action="30_search.html" method="get" class="apisearch"><input type="text" name="q" placeholder="Search scripting..." autosave="Unity Reference" results="5" class="sbox field" id="q"></input><input type="submit" class="submit"></input></form></div><ul><li><a href="../Manual/index.html">Manual</a></li><li><a href="../ScriptReference/index.html" class="selected">Scripting API</a></li></ul></div></div><div class="more"><div class="filler"></div><ul><li><a href="https://unity3d.com/">unity3d.com</a></li></ul></div></div></div><div class="toolbar"><div class="content clear"><div class="version-number">Version: <b>2018.2</b> (switch to <a href="https://docs.unity3d.com/2018.3/Documentation/ScriptReference">2018.3b</a> or <a href="https://docs.unity3d.com/2017.4/Documentation/ScriptReference">2017.4</a>)</div><div class="lang-switcher hide"><div class="current toggle" data-target=".lang-list"><div class="lbl">Language<span class="b">English</span></div><div class="arrow"></div></div><div class="lang-list" style="display:none;"><ul><li><a href="">English</a></li></ul></div></div><div class="script-lang"><ul><li class="selected" data-lang="CS">C#</li></ul></div></div></div></div><div id="master-wrapper" class="master-wrapper clear"><div id="sidebar" class="sidebar"><div class="sidebar-wrap"><div class="content"><div class="sidebar-menu"><div class="toc"><h2>Scripting API</h2></div></div></div></div></div><div id="content-wrap" class="content-wrap"><div class="content-block"><div class="content"><div class="section"><div class="mb20 clear" id=""><h1 class="heading inherit"><a href="Networking.NetworkTransport.html">NetworkTransport</a>.Send</h1><div class="clear"></div><div class="otherversionswrapper" onmouseover="setOtherVersionsDisplay(true)" onmouseout="setOtherVersionsDisplay(false)"><a>Other Versions</a><div class="otherversionscontent" id="OtherVersionsContent" style="display:none;"></div></div><div class="scrollToFeedback"><a id="scrollToFeedback">Leave feedback</a></div><div class="clear"></div><div class="suggest"><a class="blue-btn sbtn">Suggest a change</a><div class="suggest-wrap rel hide"><div class="loading hide"><div></div><div></div><div></div></div><div class="suggest-success hide"><h2>Success!</h2><p>Thank you for helping us improve the quality of Unity Documentation. Although we cannot accept all submissions, we do read each suggested change from our users and will make updates where applicable.</p><a class="gray-btn sbtn close">Close</a></div><div class="suggest-failed hide"><h2>Submission failed</h2><p>For some reason your suggested change could not be submitted. Please &lt;a&gt;try again&lt;/a&gt; in a few minutes. And thank you for taking the time to help us improve the quality of Unity Documentation.</p><a class="gray-btn sbtn close">Close</a></div><div class="suggest-form clear"><label for="suggest_name">Your name</label><input id="suggest_name" type="text"></input><label for="suggest_email">Your email</label><input id="suggest_email" type="email"></input><label for="suggest_body" class="clear">Suggestion<span class="r">*</span></label><textarea id="suggest_body" class="req"></textarea><button id="suggest_submit" class="blue-btn mr10">Submit suggestion</button><p class="mb0"><a class="cancel left lh42 cn">Cancel</a></p></div></div></div><a href="" class="switch-link gray-btn sbtn left hide"></a><div class="clear"></div></div><div class="subsection"><div class="signature"><div class="signature-CS sig-block"><span style="color:red;"></span>public static bool <span class="sig-kw">Send</span>(int <span class="sig-kw">hostId</span>,
int <span class="sig-kw">connectionId</span>,
int <span class="sig-kw">channelId</span>,
byte[] <span class="sig-kw">buffer</span>,
int <span class="sig-kw">size</span>,
out byte <span class="sig-kw">error</span>);
    </div></div></div><div class="subsection"><h2>Parameters</h2><table class="list"><tr><td class="name lbl">hostId</td><td class="desc">Host ID associated with this connection.</td></tr><tr><td class="name lbl">connectionId</td><td class="desc">ID of the connection.</td></tr><tr><td class="name lbl">channelId</td><td class="desc">The channel ID to send on.</td></tr><tr><td class="name lbl">buffer</td><td class="desc">Buffer containing the data to send.</td></tr><tr><td class="name lbl">size</td><td class="desc">Size of the buffer.</td></tr><tr><td class="name lbl">error</td><td class="desc">Error (can be cast to <a href="Networking.NetworkError.html">NetworkError</a> for more information).</td></tr></table></div><div class="subsection"><h2>Description</h2><p>Send data to peer.</p></div><div class="subsection"><p>Use this to send data from one connection to another using the sender’s <em>hostId</em> and <em>connectionId</em>. Place the data to be sent in the function as a byte array, along with the maximum size of the data. To create the channelID, see <a href="Networking.QosType.html">QosType</a>.
Make sure to set up the receiver to listen for data being sent by using <a href="Networking.NetworkTransport.Receive.html">NetworkTransport.Receive</a>.</p></div><div class="subsection">
        
        <pre class="codeExampleCS">
//The script below shows how to set up connections ready to use <a href="Networking.NetworkTransport.Send.html">NetworkTransport.Send</a><br /><br />//To make this work, create an empty <a href="GameObject.html">GameObject</a> and attach this script<br /><br />//Make sure there is a <a href="Networking.NetworkManager.html">NetworkManager</a> in your <a href="SceneManagement.Scene.html">Scene</a>. To add one, click on a <a href="GameObject.html">GameObject</a> and click the <strong>Add Component</strong> Button in the Inspector window. Go to <strong>Network</strong>&gt;<strong>Network Manager</strong>.<br /><br />//Create 2 Buttons (<strong>Create</strong>&gt;<strong>UI</strong>&gt;<strong>Button</strong>), one for a client and the other a server.<br /><br />//Create an <a href="Input.html">Input</a> Field (<strong>Create</strong>&gt;<strong>UI</strong>&gt;<strong>Input Field</strong>).<br /><br />//Attach all of these in the Inspector of your <a href="GameObject.html">GameObject</a>.<br /><br />//Build and run a version of your <a href="SceneManagement.Scene.html">Scene</a>. Press the “server” button on this side.<br /><br />//In the Unity <a href="Editor.html">Editor</a>, press the Play button to have a second version running. Click the client Button on this side. A text field should appear that allows you to type a message if your connection worked. Press the return or enter key to send this message from the “client” side using <a href="Networking.NetworkTransport.Send.html">NetworkTransport.Send</a><br /><br />//The script then receives the message using <a href="Networking.NetworkTransport.Receive.html">NetworkTransport.Receive</a>, and outputs the message on the “server” side. Go to your built version of the <a href="Application.html">Application</a> (server side) to see the message in your <a href="Input.html">Input</a> Field.<br /><br />using UnityEngine;
using UnityEngine.Networking;
using UnityEngine.UI;
using System.Runtime.Serialization.Formatters.Binary;
using System.IO;<br /><br />public class Example : <a href="MonoBehaviour.html">MonoBehaviour</a>
{
    int m_ServerSocket;
    int m_ClientSocket;
    int m_ConnectionID;
    byte m_ChannelID;<br /><br />    <a href="Networking.HostTopology.html">HostTopology</a> m_HostTopology;
    bool m_ClientsActive;
    string myText;<br /><br />    //These are the Buttons that start the client and server, and the Button for sending messages
    //Assure that you assign these in the Inspector before testing
    public Button m_ClientButton, m_ServerButton;
    //This is the <a href="Input.html">Input</a> Field for writing messages. Assign it in the Inspector.
    public <a href="UI.InputField.html">InputField</a> m_InputField;<br /><br />    void Start()
    {
        //Set this to false to indicate that the client hasn't connected yet
        m_ClientsActive = false;
        //Set the <a href="UI.Text.html">Text</a> in the text field to this
        myText = "Please Type <a href="VersionControl.Message.html">Message</a> Here...";<br /><br />        //Set up the <a href="MemoryProfiler.Connection.html">Connection</a> Configuration which holds channel information
        <a href="Networking.ConnectionConfig.html">ConnectionConfig</a> config = new <a href="Networking.ConnectionConfig.html">ConnectionConfig</a>();
        //Add a reliable channel mode to the configuration (all messages delivered, not particularly in order)
        m_ChannelID = config.AddChannel(<a href="Networking.QosType.Reliable.html">QosType.Reliable</a>);
        //Create a new Host information based on the configuration created, and the maximum connections allowed (20)
        m_HostTopology = new <a href="Networking.HostTopology.html">HostTopology</a>(config, 20);
        //Initialise the <a href="Networking.NetworkTransport.html">NetworkTransport</a>
        <a href="Networking.NetworkTransport.Init.html">NetworkTransport.Init</a>();<br /><br />        //Call the ClientButton function when you click the Button
        m_ClientButton.onClick.AddListener(ClientButton);
        //Call the ServerButton function when you click the server Button
        m_ServerButton.onClick.AddListener(ServerButton);
        //Call the SendMessageField function when you press the return/enter key on the <a href="Input.html">Input</a> Field
        m_InputField.onEndEdit.AddListener(delegate {SendMessageField(); });
    }<br /><br />    //This is the function that serializes the message before sending it
    void SendMyMessage(string textInput)
    {
        byte error;
        byte[] buffer = new byte[1024];
        Stream message = new MemoryStream(buffer);
        BinaryFormatter formatter = new BinaryFormatter();
        //Serialize the message
        formatter.Serialize(message , textInput);<br /><br />        //Send the message from the "client" with the serialized message and the connection information
        <a href="Networking.NetworkTransport.Send.html">NetworkTransport.Send</a>(m_ClientSocket , m_ConnectionID , m_ChannelID , buffer , (int)message.Position , out error);<br /><br />        //If there is an error, output message error to the console
        if ((<a href="Networking.NetworkError.html">NetworkError</a>)error != <a href="Networking.NetworkError.Ok.html">NetworkError.Ok</a>)
        {
            <a href="Debug.Log.html">Debug.Log</a>("<a href="VersionControl.Message.html">Message</a> send error: " + (<a href="Networking.NetworkError.html">NetworkError</a>)error);
        }
    }<br /><br />    void <a href="Experimental.PlayerLoop.Update.html">Update</a>()
    {
        //These are the variables that are replaced by the incoming message
        int outHostId;
        int outConnectionId;
        int outChannelId;
        byte[] buffer = new byte[1024];
        int receivedSize;
        byte error;<br /><br />        //Set up the Network Transport to receive the incoming message, and decide what type of event
        <a href="Networking.NetworkEventType.html">NetworkEventType</a> eventType = <a href="Networking.NetworkTransport.Receive.html">NetworkTransport.Receive</a>(out outHostId, out outConnectionId, out outChannelId, buffer, buffer.Length, out receivedSize, out error);<br /><br />        switch (eventType)
        {
            //Use this case when there is a connection detected
            case <a href="Networking.NetworkEventType.ConnectEvent.html">NetworkEventType.ConnectEvent</a>:
            {
                //Call the function to deal with the received information
                OnConnect(outHostId, outConnectionId, (<a href="Networking.NetworkError.html">NetworkError</a>)error);
                break;
            }<br /><br />            //This case is called if the event type is a data event, like the serialized message
            case <a href="Networking.NetworkEventType.DataEvent.html">NetworkEventType.DataEvent</a>:
            {
                //Call the function to deal with the received data
                OnData(outHostId, outConnectionId, outChannelId, buffer, receivedSize, (<a href="Networking.NetworkError.html">NetworkError</a>)error);
                break;
            }<br /><br />            case <a href="Networking.NetworkEventType.Nothing.html">NetworkEventType.Nothing</a>:
                break;<br /><br />            default:
                //Output the error
                <a href="Debug.LogError.html">Debug.LogError</a>("Unknown network message type received: " + eventType);
                break;
        }<br /><br />        //Make sure there is a connection first before showing the <a href="Input.html">Input</a> Field
        m_InputField.gameObject.SetActive(m_ClientsActive);
        //Remove Buttons when there is a connection
        if (m_ClientsActive)
        {
            m_ClientButton.gameObject.SetActive(false);
            m_ServerButton.gameObject.SetActive(false);
        }
    }<br /><br />    //This function is called when a connection is detected
    void OnConnect(int hostID, int connectionID, <a href="Networking.NetworkError.html">NetworkError</a> error)
    {
        //Output the given information to the console
        <a href="Debug.Log.html">Debug.Log</a>("OnConnect(hostId = " + hostID + ", connectionId = "
            + connectionID + ", error = " + error.ToString() + ")");
        //There was a connection, so make this return true
        m_ClientsActive = true;
    }<br /><br />    //This function is called when data is sent
    void OnData(int hostId, int connectionId, int channelId, byte[] data, int size, <a href="Networking.NetworkError.html">NetworkError</a> error)
    {
        //Here the message being received is deserialized and output to the console
        Stream serializedMessage = new MemoryStream(data);
        BinaryFormatter formatter = new BinaryFormatter();
        string message = formatter.Deserialize(serializedMessage).ToString();<br /><br />        //Output the deserialized message as well as the connection information to the console
        <a href="Debug.Log.html">Debug.Log</a>("OnData(hostId = " + hostId + ", connectionId = "
            + connectionId + ", channelId = " + channelId + ", data = "
            + message + ", size = " + size + ", error = " + error.ToString() + ")");<br /><br />        m_InputField.text = "data = " + message;
    }<br /><br />    void ClientButton()
    {
        byte error;
        m_ClientSocket = <a href="Networking.NetworkTransport.AddHost.html">NetworkTransport.AddHost</a>(m_HostTopology);
        //Connect the hostID to the port
        m_ConnectionID = <a href="Networking.NetworkTransport.Connect.html">NetworkTransport.Connect</a>(m_ClientSocket, "127.0.0.1", 54321, 0, out error);
        //If any errors arise from the connection, output it in the console
        if ((<a href="Networking.NetworkError.html">NetworkError</a>)error != <a href="Networking.NetworkError.Ok.html">NetworkError.Ok</a>)
        {
            <a href="Debug.Log.html">Debug.Log</a>("<a href="PackageManager.Error.html">Error</a>: " + (<a href="Networking.NetworkError.html">NetworkError</a>)error);
        }
    }<br /><br />    void ServerButton()
    {
        byte error;
        //Open the sockets for sending and receiving the messages on port 54321
        m_ServerSocket = <a href="Networking.NetworkTransport.AddHost.html">NetworkTransport.AddHost</a>(m_HostTopology, 54321);
        //Connect the "server"
        <a href="Networking.NetworkTransport.Connect.html">NetworkTransport.Connect</a>(m_ServerSocket, "127.0.0.1", 54321, 0, out error);
    }<br /><br />    void SendMessageField()
    {
        //Check to see if a client has been chosen yet before showing the <a href="Experimental.UIElements.TextField.html">TextField</a> and the Button
        //The <a href="UI.Text.html">Text</a> from the <a href="UI.InputField.html">InputField</a> is stored here
        myText = m_InputField.text;<br /><br />        //Send the data message
        SendMyMessage(myText);
    }
}
</pre>
      </div></div><div class="section"><div class="feedbackbox" id="feedbackbox"><div id="rating"><p>Did you find this page useful? Please give it a rating:<br /><div id="ratecontent" class="c-rating"></div></p></div><div id="ratingThanks" style="display:none"><p>Thanks for rating this page!</p></div><div id="problem"><p><a name="problem">Report a problem on this page</a></p></div><div id="problemType" style="display:none"><p>What kind of problem would you like to report?<ul type="problems"><li><a name="needcode" id="problemneedcode">This page needs code samples</a></li><li><a name="code" id="problemcode">Code samples do not work</a></li><li><a name="missing" id="problemmissing">Information is missing</a></li><li><a name="incorrect" id="problemincorrect">Information is incorrect</a></li><li><a name="unclear" id="problemunclear">Information is unclear or confusing</a></li><li><a name="language" id="problemlanguage">There is a spelling/grammar error on this page</a></li><li><a name="other" id="problemother">Something else</a></li></ul><p><known_issues>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at </known_issues></p></p></div><div id="problemThanks" style="display:none"><p>Thanks for letting us know! This page has been marked for review based on your feedback.<br /><br />If you have time, you can provide more information to help us fix the problem faster.<br /><br /><a id="problemThanksMoreInfoButton">Provide more information</a><br /></p></div><div id="problemMoreInfo" style="display:none"><p id="problemNeedCodeForm" style="display:none">You've told us this page needs code samples. If you'd like to help us further, you could provide a code sample, or tell us about what kind of code sample you'd like to see:</p><p id="problemCodeForm" style="display:none">You've told us there are code samples on this page which don't work. If you know how to fix it, or have something better we could use instead, please let us know:</p><p id="problemMissingForm" style="display:none">You've told us there is information missing from this page. Please tell us more about what's missing:</p><p id="problemIncorrectForm" style="display:none">You've told us there is incorrect information on this page. If you know what we should change to make it correct, please tell us:</p><p id="problemUnclearForm" style="display:none">You've told us this page has unclear or confusing information. Please tell us more about what you found unclear or confusing, or let us know how we could make it clearer:</p><p id="problemLanguageForm" style="display:none">You've told us there is a spelling or grammar error on this page. Please tell us what's wrong:</p><p id="problemOtherForm" style="display:none">You've told us this page has a problem. Please tell us more about what's wrong:</p><form><textarea id="problemFormSuggestionField" cols="40" rows="5"></textarea><input type="hidden" id="problemFormDescription"></input><input type="submit" id="problemFormDescriptionSubmit" value="Submit"></input></form></div><div id="problemMoreInfoThanks" style="display:none"><p>Thanks for helping to make the Unity documentation better!</p></div><script>InitialiseStarRating();</script></div></div><div class="footer-wrapper"><div class="footer clear"><div class="copy"><p><known_issues>Is something described here not working as you expect it to? It might be a <b>Known Issue</b>. Please check with the Issue Tracker at </known_issues><a href="https://issuetracker.unity3d.com">issuetracker.unity3d.com</a>.</p>Copyright © 2018 Unity Technologies. Publication: 2018.2-002K. Built: 2018-10-10.</div><div class="menu"><a href="https://unity3d.com/learn">Tutorials</a><a href="https://answers.unity3d.com">Community Answers</a><a href="https://support.unity3d.com/hc/en-us">Knowledge Base</a><a href="https://forum.unity3d.com">Forums</a><a href="https://unity3d.com/asset-store">Asset Store</a></div></div></div></div></div></div></div></body></html>